!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function r(e,n="ASC",t="price"){return"price"===t&&"ASC"===n?e.sort((e,n)=>e.pricePerMonth>n.pricePerMonth?1:n.pricePerMonth>e.pricePerMonth?-1:0):"price"===t&&"DESC"===n&&e.sort((e,n)=>e.pricePerMonth<n.pricePerMonth?1:n.pricePerMonth<e.pricePerMonth?-1:0),"relevance"===t&&"ASC"===n?e.sort((e,n)=>e.relevance>n.relevance?1:n.relevance>e.relevance?-1:0):"relevance"===t&&"DESC"===n&&e.sort((e,n)=>e.relevance<n.relevance?1:n.relevance<e.relevance?-1:0),e}function o(e){var n="";return e.forEach(e=>{var t=e.instantBooking.isEnabled?'<a href="#" class="btn btn-secondary">Book now</a>':"",r=`\n    <div class="homecard m20 p15 ">\n      <div class="imgMask w25">\n        <a href="https://staging.spotahome.com${e.url}">\n          <img src="${e.mainPhotoUrl}" alt="${e.mainPhotoUrl}" class="w100"/>\n        </a>\n      </div>\n      <div class="info container w75">\n        <h2 class="title font-secondary m0"><a href="https://staging.spotahome.com${e.url}">${e.title}</a></h2>\n        <span class="price font-primary">${e.pricePerMonth} ${e.currencySymbol}</span>\n      </div>\n      <div class="actions">\n          <a href="https://staging.spotahome.com${e.url}" class="btn btn-primary">View details</a>\n          ${t}\n        </div>\n    </div>`;n+=r}),n}function a(e){window.localStorage?localStorage.setItem("properties",JSON.stringify(e)):console.warn("Su navegador no soporta localStorage")}function i(){if(window.localStorage){var e=localStorage.getItem("properties");return JSON.parse(e)}console.warn("Su navegador no soporta localStorage")}function c(e=""){var n=document.getElementById("loading");"hidden"==e?n.classList.add("hidden"):n.classList.remove("hidden")}function l(){var e=window.location.pathname;return""!=e&&"/"!=e&&!1!==["/madrid","/barcelona","/london"].includes(e)||(e="/madrid",window.location.pathname=e),e}function s(e="/madrid",n=null,t="price:ASC"){var o=t.split(":"),a=o[1],i=o[0];return new Promise((t,o)=>{(async function(e=null,n="/madrid"){const t=`https://staging.spotahome.com/api/public/listings/search/markers${n}${["apartments","rooms","studios","residences"].includes(e)?"?type[]="+e:""}`;return await fetch(t).then(e=>e.json()).then(e=>{if(e.ok)return e.data}).catch(function(e){console.log(e)})})(n,e).then(e=>(async function(e,n=0,t=30){var r=e.slice(n,t),o="",a=[];for(let e=0;e<r.length;e++){const n=r[e];o+=0==e?`?ids[]=${n.id}`:`&ids[]=${n.id}`,a[n.id]=n.relevance}let i=`https://staging.spotahome.com/api/public/listings/search/homecards_ids${o}`;return await fetch(i).then(e=>e.json()).then(e=>{if(e.ok){var n=e.data.homecards;for(let e=0;e<n.length;e++)n[e].relevance=a[n[e].id];return n}}).catch(function(e){console.log(e)})})(e).then(e=>e).catch(e=>o(e))).then(e=>{r(e,a,i),t(e)}).catch(e=>o(e))})}t.r(n),console.log("AplicaciÃ³n cargada"),s(l()).then(e=>{if(console.log(e),e.length>0){a(e);var n=o(e);document.getElementById("content").innerHTML=n,c("hidden")}});var d=document.getElementById("filter_property_type"),u=document.getElementById("sort_by"),p=document.getElementById("downloadJson");d.addEventListener("change",e=>{!function(e){c();var n=document.getElementById("sort_by").value;s(l(),e,n).then(e=>{if(e.length>0){a(e);var n=o(e);document.getElementById("content").innerHTML=n,c("hidden")}})}(e.target.value)}),u.addEventListener("change",e=>{!function(e){c();var n=e.split(":"),t=n[1],l=n[0],s=i();r(s,t,l),a(s);var d=o(s);document.getElementById("content").innerHTML=d,c("hidden")}(e.target.value)}),p.addEventListener("click",()=>{!function(){var e=i(),n=JSON.stringify(e),t=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(t),o=document.getElementById("downloadJson");o.setAttribute("href",r),o.setAttribute("download","properties.json")}()})}]);